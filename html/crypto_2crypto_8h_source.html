<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Monero: src/crypto/crypto.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Monero
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4261af1259721e3e39e0d2dd7354b511.html">crypto</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">crypto.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="crypto_2crypto_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (c) 2014-2019, The Monero Project</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// All rights reserved.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Redistribution and use in source and binary forms, with or without modification, are</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// permitted provided that the following conditions are met:</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// 1. Redistributions of source code must retain the above copyright notice, this list of</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//    conditions and the following disclaimer.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// 2. Redistributions in binary form must reproduce the above copyright notice, this list</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//    of conditions and the following disclaimer in the documentation and/or other</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//    materials provided with the distribution.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// 3. Neither the name of the copyright holder nor the names of its contributors may be</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//    used to endorse or promote products derived from this software without specific</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//    prior written permission.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// Parts of this file are originally copyright (c) 2012-2013 The Cryptonote developers</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;epee/memwipe.h&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;epee/mlocker.h&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hash_8h.html">hash.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="crypto_2base_8h.html">base.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="crypto_2random_8h.html">random.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacecrypto.html">crypto</a> {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structcrypto_1_1ec__point.html">   52</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1ec__point.html">ec_point</a> : <a class="code" href="structcrypto_1_1bytes.html">bytes</a>&lt;32, true&gt; {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// Returns true if non-null, i.e. not all 0.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="structcrypto_1_1ec__point.html#a741bab033257351d34531f1c75db2857">   54</a></span>&#160;    <span class="keyword">explicit</span> <span class="keyword">operator</span> <a class="code" href="stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structcrypto_1_1bytes.html#a06d1434cd0b17a3bcba8a01daadc6b97">data_</a> != null&lt;ec_point&gt;.data_; }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  };</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structcrypto_1_1ec__scalar.html">   57</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1ec__scalar.html">ec_scalar</a> : <a class="code" href="structcrypto_1_1bytes.html">bytes</a>&lt;32&gt; {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// constant-time (via libsodium)</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structcrypto_1_1ec__scalar.html#a8e4b5bb2649281e3460ee2f61298e0b2">operator==</a>(<span class="keyword">const</span> <a class="code" href="structcrypto_1_1ec__scalar.html">ec_scalar</a>&amp; x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="structcrypto_1_1ec__scalar.html#ae08361a85f18a2f8d8cdb3252cf86de0">   60</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structcrypto_1_1ec__scalar.html#ae08361a85f18a2f8d8cdb3252cf86de0">operator!=</a>(<span class="keyword">const</span> <a class="code" href="structcrypto_1_1ec__scalar.html">ec_scalar</a>&amp; x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !(*<span class="keyword">this</span> == x); }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// constant-time returns true if not all 0.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">explicit</span> <span class="keyword">operator</span> <a class="code" href="stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  };</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structcrypto_1_1public__key.html">   65</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1public__key.html">public_key</a> : <a class="code" href="structcrypto_1_1ec__point.html">ec_point</a> {};</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structcrypto_1_1secret__key__.html">   67</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1secret__key__.html">secret_key_</a> : <a class="code" href="structcrypto_1_1ec__scalar.html">ec_scalar</a> {};</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">   68</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> = epee::mlocked&lt;tools::scrubbed&lt;secret_key_&gt;&gt;;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="namespacecrypto.html#a4ae124b7833ddd01cfd9ef6a47c902f4">   70</a></span>&#160;  <span class="keyword">template</span> &lt;&gt; <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> <a class="code" href="namespacecrypto.html#a4ae124b7833ddd01cfd9ef6a47c902f4">null&lt;secret_key&gt;</a>{};</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structcrypto_1_1key__derivation.html">   72</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1key__derivation.html">key_derivation</a>: <a class="code" href="structcrypto_1_1ec__point.html">ec_point</a> {};</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structcrypto_1_1key__image.html">   74</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1key__image.html">key_image</a>: <a class="code" href="structcrypto_1_1ec__point.html">ec_point</a> {};</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structcrypto_1_1signature.html">   76</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1signature.html">signature</a> : <a class="code" href="structcrypto_1_1bytes.html">bytes</a>&lt;64, true&gt; {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// Returns or sets the &quot;c&quot; part of the signature bytes</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structcrypto_1_1signature.html#affb0ccf512e72c66cb2a4bb22aaaa6c9">   78</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="structcrypto_1_1signature.html#affb0ccf512e72c66cb2a4bb22aaaa6c9">c</a>() { <span class="keywordflow">return</span> <a class="code" href="structcrypto_1_1bytes.html#a90e5cb3c7732d48e83b52c9c6b2d7677">data</a>(); }</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structcrypto_1_1signature.html#a7811e9dfca37cf268d4a79424dc78ba0">   79</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="structcrypto_1_1signature.html#a7811e9dfca37cf268d4a79424dc78ba0">c</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structcrypto_1_1bytes.html#a90e5cb3c7732d48e83b52c9c6b2d7677">data</a>(); }</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structcrypto_1_1signature.html#a4b4a734143a3a02dacf2b8d78dea21e6">   80</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structcrypto_1_1signature.html#a4b4a734143a3a02dacf2b8d78dea21e6">c</a>(<span class="keyword">const</span> <a class="code" href="structcrypto_1_1ec__scalar.html">ec_scalar</a>&amp; <a class="code" href="structcrypto_1_1signature.html#affb0ccf512e72c66cb2a4bb22aaaa6c9">c</a>) { <a class="code" href="namespacerct.html#ad77d0fb2279743febea3fb652f96c77b">std::copy</a>(<a class="code" href="structcrypto_1_1signature.html#affb0ccf512e72c66cb2a4bb22aaaa6c9">c</a>.data(), <a class="code" href="structcrypto_1_1signature.html#affb0ccf512e72c66cb2a4bb22aaaa6c9">c</a>.data() + <a class="code" href="structcrypto_1_1signature.html#affb0ccf512e72c66cb2a4bb22aaaa6c9">c</a>.size(), <a class="code" href="structcrypto_1_1bytes.html#a90e5cb3c7732d48e83b52c9c6b2d7677">data</a>()); }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// Returns or sets the &quot;r&quot; part of the signature bytes</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structcrypto_1_1signature.html#a87cded961e1150be2db3aa28a07943a0">   82</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="structcrypto_1_1signature.html#a87cded961e1150be2db3aa28a07943a0">r</a>() { <span class="keywordflow">return</span> <a class="code" href="structcrypto_1_1bytes.html#a90e5cb3c7732d48e83b52c9c6b2d7677">data</a>() + 32; }</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structcrypto_1_1signature.html#a22fdf0da6faeaee04ca83e4474b808cd">   83</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="structcrypto_1_1signature.html#a22fdf0da6faeaee04ca83e4474b808cd">r</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structcrypto_1_1bytes.html#a90e5cb3c7732d48e83b52c9c6b2d7677">data</a>() + 32; }</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structcrypto_1_1signature.html#ae4fc0a1e1eccf1242e859175e068507b">   84</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structcrypto_1_1signature.html#ae4fc0a1e1eccf1242e859175e068507b">r</a>(<span class="keyword">const</span> <a class="code" href="structcrypto_1_1ec__scalar.html">ec_scalar</a>&amp; <a class="code" href="structcrypto_1_1signature.html#a87cded961e1150be2db3aa28a07943a0">r</a>) { <a class="code" href="namespacerct.html#ad77d0fb2279743febea3fb652f96c77b">std::copy</a>(<a class="code" href="structcrypto_1_1signature.html#a87cded961e1150be2db3aa28a07943a0">r</a>.data(), <a class="code" href="structcrypto_1_1signature.html#a87cded961e1150be2db3aa28a07943a0">r</a>.data() + <a class="code" href="structcrypto_1_1signature.html#a87cded961e1150be2db3aa28a07943a0">r</a>.size(), <a class="code" href="structcrypto_1_1bytes.html#a90e5cb3c7732d48e83b52c9c6b2d7677">data</a>()); }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Returns true if non-null, i.e. not 0.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structcrypto_1_1signature.html#a54a352eb743ce9f713d8f4009d59313d">   87</a></span>&#160;    <span class="keyword">explicit</span> <span class="keyword">operator</span> <a class="code" href="stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structcrypto_1_1bytes.html#a06d1434cd0b17a3bcba8a01daadc6b97">data_</a> != null&lt;signature&gt;.data_; }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  };</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structcrypto_1_1ed25519__public__key.html">   90</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1ed25519__public__key.html">ed25519_public_key</a> : <a class="code" href="structcrypto_1_1ec__point.html">ec_point</a> {};</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// 64 = crypto_sign_ed25519_SECRETKEYBYTES (but we don&#39;t depend on libsodium header here)</span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="structcrypto_1_1ed25519__secret__key__.html">   93</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1ed25519__secret__key__.html">ed25519_secret_key_</a> : <a class="code" href="structcrypto_1_1bytes.html">bytes</a>&lt;64&gt; {};</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="namespacecrypto.html#a075f95a5c71c1122b5f77074c4fc23b4">   94</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacecrypto.html#a075f95a5c71c1122b5f77074c4fc23b4">ed25519_secret_key</a> = epee::mlocked&lt;tools::scrubbed&lt;ed25519_secret_key_&gt;&gt;;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="structcrypto_1_1ed25519__signature.html">   96</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1ed25519__signature.html">ed25519_signature</a> : <a class="code" href="structcrypto_1_1bytes.html">bytes</a>&lt;64, true&gt; {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// Returns true if non-null, i.e. not 0.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="structcrypto_1_1ed25519__signature.html#a8a2b0f3209c0aa98b1330fe295b4dea4">   98</a></span>&#160;    <span class="keyword">explicit</span> <span class="keyword">operator</span> <a class="code" href="stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structcrypto_1_1bytes.html#a06d1434cd0b17a3bcba8a01daadc6b97">data_</a> != null&lt;ed25519_signature&gt;.data_; }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  };</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structcrypto_1_1x25519__public__key.html">  101</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1x25519__public__key.html">x25519_public_key</a> : <a class="code" href="structcrypto_1_1ec__point.html">ec_point</a> {};</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="structcrypto_1_1x25519__secret__key__.html">  103</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1x25519__secret__key__.html">x25519_secret_key_</a> : <a class="code" href="structcrypto_1_1bytes.html">bytes</a>&lt;32&gt; {};</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="namespacecrypto.html#ac56b84b74a2730200de5932b1e9b3d5a">  104</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacecrypto.html#ac56b84b74a2730200de5932b1e9b3d5a">x25519_secret_key</a> = epee::mlocked&lt;tools::scrubbed&lt;x25519_secret_key_&gt;&gt;;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#ad91deb84b3eac266145c5329598f282a">hash_to_scalar</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *data, <span class="keywordtype">size_t</span> length, <a class="code" href="structcrypto_1_1ec__scalar.html">ec_scalar</a> &amp;res);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="structcrypto_1_1ec__scalar.html">ec_scalar</a> <a class="code" href="namespacecrypto.html#ad91deb84b3eac266145c5329598f282a">hash_to_scalar</a>(<span class="keyword">const</span> <span class="keywordtype">void</span>* data, <span class="keywordtype">size_t</span> length);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#ac8015c4c3519492dcfeacc5cc1e9bc4d">random_scalar</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="structcrypto_1_1bytes.html">bytes</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#ac8015c4c3519492dcfeacc5cc1e9bc4d">random_scalar</a>(<a class="code" href="structcrypto_1_1ec__scalar.html">ec_scalar</a>&amp; res);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="structcrypto_1_1ec__scalar.html">ec_scalar</a> <a class="code" href="namespacecrypto.html#ac8015c4c3519492dcfeacc5cc1e9bc4d">random_scalar</a>();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#a1550cf25f2aebaf6dc33db1d7bc91958">generate_random_bytes_thread_safe</a>(<span class="keywordtype">size_t</span> N, uint8_t *<a class="code" href="structcrypto_1_1bytes.html">bytes</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#a001bf17b07412f27d556b3f937c144bb">add_extra_entropy_thread_safe</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *ptr, <span class="keywordtype">size_t</span> <a class="code" href="structcrypto_1_1bytes.html">bytes</a>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">/* Generate N random bytes</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="namespacecrypto.html#a9d13de4bc0185a688e9a78b752ff2a1f">  117</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#a9d13de4bc0185a688e9a78b752ff2a1f">rand</a>(<span class="keywordtype">size_t</span> N, uint8_t *<a class="code" href="structcrypto_1_1bytes.html">bytes</a>) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="namespacecrypto.html#a1550cf25f2aebaf6dc33db1d7bc91958">generate_random_bytes_thread_safe</a>(N, <a class="code" href="structcrypto_1_1bytes.html">bytes</a>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">/* Generate a value filled with random bytes.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="namespacecrypto.html#afe67f2aa382532376a749cc91402ebe3">  124</a></span>&#160;  <span class="keyword">typename</span> <a class="code" href="namespaceserialization.html#a2c903a13fe2f03de6d83908a3be64bcf">std::enable_if&lt;std::is_pod&lt;T&gt;::value</a>, <a class="code" href="groestl__tables_8h.html#a0735f92342601a6dcd26111ace40500a">T</a>&gt;::type <a class="code" href="namespacecrypto.html#a9d13de4bc0185a688e9a78b752ff2a1f">rand</a>() {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keyword">typename</span> <a class="code" href="namespaceepee_1_1net__utils.html#a746609002779213cd81f8754611bce59">std::remove_cv&lt;T&gt;::type</a> res;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="namespacecrypto.html#a1550cf25f2aebaf6dc33db1d7bc91958">generate_random_bytes_thread_safe</a>(<span class="keyword">sizeof</span>(<a class="code" href="groestl__tables_8h.html#a0735f92342601a6dcd26111ace40500a">T</a>), (uint8_t*)&amp;res);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">/* UniformRandomBitGenerator using crypto::rand&lt;uint64_t&gt;()</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="structcrypto_1_1random__device.html">  132</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcrypto_1_1random__device.html">random_device</a></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  {</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="structcrypto_1_1random__device.html#acb2b7fc7b2eddf8df0a53da949480ce7">  134</a></span>&#160;    <span class="keyword">typedef</span> uint64_t <a class="code" href="structcrypto_1_1random__device.html#acb2b7fc7b2eddf8df0a53da949480ce7">result_type</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="structcrypto_1_1random__device.html#a0bc84178203908cbb72af1be7d535a2a">  135</a></span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structcrypto_1_1random__device.html#acb2b7fc7b2eddf8df0a53da949480ce7">result_type</a> <a class="code" href="structcrypto_1_1random__device.html#a0bc84178203908cbb72af1be7d535a2a">min</a>() { <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="structcrypto_1_1random__device.html#ae0bc45ae433a62210c0009ca3d1b34d2">  136</a></span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structcrypto_1_1random__device.html#acb2b7fc7b2eddf8df0a53da949480ce7">result_type</a> <a class="code" href="structcrypto_1_1random__device.html#ae0bc45ae433a62210c0009ca3d1b34d2">max</a>() { <span class="keywordflow">return</span> <a class="code" href="structcrypto_1_1random__device.html#acb2b7fc7b2eddf8df0a53da949480ce7">result_type</a>(-1); }</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="structcrypto_1_1random__device.html#aae1bc3cc2e6c8fdb609eb2ff5ceeb787">  137</a></span>&#160;    <a class="code" href="structcrypto_1_1random__device.html#acb2b7fc7b2eddf8df0a53da949480ce7">result_type</a> <a class="code" href="structcrypto_1_1random__device.html#aae1bc3cc2e6c8fdb609eb2ff5ceeb787">operator()</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> crypto::rand&lt;result_type&gt;(); }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  };</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">/* Generate a random value between range_min and range_max</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="namespacecrypto.html#a5dbb69c6a4a5276a98142e36f63bbb0b">  143</a></span>&#160;  <span class="keyword">typename</span> <a class="code" href="namespaceserialization.html#a2c903a13fe2f03de6d83908a3be64bcf">std::enable_if&lt;std::is_integral&lt;T&gt;::value</a>, <a class="code" href="groestl__tables_8h.html#a0735f92342601a6dcd26111ace40500a">T</a>&gt;::type <a class="code" href="namespacecrypto.html#a5dbb69c6a4a5276a98142e36f63bbb0b">rand_range</a>(<a class="code" href="groestl__tables_8h.html#a0735f92342601a6dcd26111ace40500a">T</a> range_min, <a class="code" href="groestl__tables_8h.html#a0735f92342601a6dcd26111ace40500a">T</a> range_max) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="structcrypto_1_1random__device.html">crypto::random_device</a> rd;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    std::uniform_int_distribution&lt;T&gt; dis(range_min, range_max);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">return</span> dis(rd);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">/* Generate a random index between 0 and sz-1</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="namespacecrypto.html#acdb7a135ca10ba49bd82912186ebb19b">  152</a></span>&#160;  <span class="keyword">typename</span> <a class="code" href="namespaceserialization.html#a2c903a13fe2f03de6d83908a3be64bcf">std::enable_if&lt;std::is_unsigned&lt;T&gt;::value</a>, <a class="code" href="groestl__tables_8h.html#a0735f92342601a6dcd26111ace40500a">T</a>&gt;::type <a class="code" href="namespacecrypto.html#acdb7a135ca10ba49bd82912186ebb19b">rand_idx</a>(<a class="code" href="groestl__tables_8h.html#a0735f92342601a6dcd26111ace40500a">T</a> sz) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">return</span> crypto::rand_range&lt;T&gt;(0, sz-1);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">/* Generate a new key pair</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> <a class="code" href="namespacecrypto.html#a4cfb16d15839aee35fbf7e30aa49e2dd">generate_keys</a>(public_key &amp;pub, <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> &amp;sec, <span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a>&amp; recovery_key = <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a>(), <span class="keywordtype">bool</span> recover = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">/* Check a public key. Returns true if it is valid, false otherwise.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacecrypto.html#a0ea5e169709b097e7868684aeb1a9a37">check_key</a>(<span class="keyword">const</span> public_key &amp;key);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">/* Checks a private key and computes the corresponding public key.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacecrypto.html#accad1ff5d9765b632ed9bd75e76e6d43">secret_key_to_public_key</a>(<span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> &amp;sec, public_key &amp;pub);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">/* To generate an ephemeral key used to send money to:</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">   * * The sender generates a new key pair, which becomes the transaction key. The public transaction key is included in &quot;extra&quot; field.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">   * * Both the sender and the receiver generate key derivation from the transaction key, the receivers&#39; &quot;view&quot; key and the output index.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">   * * The sender uses key derivation and the receivers&#39; &quot;spend&quot; key to derive an ephemeral public key.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">   * * The receiver can either derive the public key (to check that the transaction is addressed to him) or the private key (to spend the money).</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="structcrypto_1_1key__derivation.html">crypto::key_derivation</a> <a class="code" href="namespacecrypto.html#a829861e5b3c015c323cbda547190055d">generate_key_derivation</a>(<span class="keyword">const</span> public_key &amp;key1, <span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> &amp;key2);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacecrypto.html#a829861e5b3c015c323cbda547190055d">generate_key_derivation</a>(<span class="keyword">const</span> public_key &amp;key1, <span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> &amp;key2, key_derivation &amp;derivation);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacecrypto.html#a5afa607436148c43b0682fbb63fca7c7">derive_public_key</a>(<span class="keyword">const</span> key_derivation &amp;derivation, std::size_t output_index, <span class="keyword">const</span> public_key &amp;<a class="code" href="namespacebase.html">base</a>, public_key &amp;derived_key);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#afb4ba722c59e935c7a15d81f93c1560c">derivation_to_scalar</a>(<span class="keyword">const</span> key_derivation &amp;derivation, <span class="keywordtype">size_t</span> output_index, ec_scalar &amp;res);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#ad52cebfd5eeaab09a39314115bfccf6f">derive_secret_key</a>(<span class="keyword">const</span> key_derivation &amp;derivation, std::size_t output_index, <span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> &amp;<a class="code" href="namespacebase.html">base</a>, <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> &amp;derived_key);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacecrypto.html#a342de1d43c4f9cc51f267469284f73b9">derive_subaddress_public_key</a>(<span class="keyword">const</span> public_key &amp;out_key, <span class="keyword">const</span> key_derivation &amp;derivation, std::size_t output_index, public_key &amp;result);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">/* Generation and checking of a non-standard Monero curve 25519 signature.  This is a custom</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">   * scheme that is not Ed25519 because it uses a random &quot;r&quot; (unlike Ed25519&#39;s use of a</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">   * deterministic value), it requires pre-hashing the message (Ed25519 does not), and produces</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">   * signatures that cannot be verified using Ed25519 verification methods (because the order of</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">   * hashed values differs).</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">   * Given M = H(msg)</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">   * r = random scalar</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">   * R = rG</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">   * c = H(M || A || R)</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">   * and then the signature for this is:</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">   * s = r - ac</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">   * Signature is: (c, s)   (but in the struct these are named &quot;c&quot; and &quot;r&quot;)</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">   * Contrast this with standard Ed25519 signature:</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">   * Given M = msg</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">   * r = H(seed_hash_2nd_half || M)</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">   * R = rG</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">   * c = H(R || A || M)</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">   * s = r + ac</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">   * Signature is: (R, s)</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">   * For verification:</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">   * Monero: given signature (c, s), message hash M, and pubkey A:</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">   * R = sG + cA</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">   * Check: H(M||A||R) == c</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">   * Ed25519: given signature (R, s), (unhashed) message M, pubkey A:</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">   * Check: sB == R + H(R||A||M)A</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  signature <a class="code" href="namespacecrypto.html#a700c2f43b09780ce0f8b6d00cec1bdc9">generate_signature</a>(<span class="keyword">const</span> hash &amp;prefix_hash, <span class="keyword">const</span> public_key &amp;pub, <span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> &amp;sec);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#a700c2f43b09780ce0f8b6d00cec1bdc9">generate_signature</a>(<span class="keyword">const</span> hash &amp;prefix_hash, <span class="keyword">const</span> public_key &amp;pub, <span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> &amp;sec, signature &amp;sig);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// See above.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacecrypto.html#aa9d240b803db22c14272c092c9457187">check_signature</a>(<span class="keyword">const</span> hash &amp;prefix_hash, <span class="keyword">const</span> public_key &amp;pub, <span class="keyword">const</span> signature &amp;sig);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">/* Generation and checking of a tx proof; given a tx pubkey R, the recipient&#39;s view pubkey A, and the key</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">   * derivation D, the signature proves the knowledge of the tx secret key r such that R=r*G and D=r*A</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">   * When the recipient&#39;s address is a subaddress, the tx pubkey R is defined as R=r*B where B is the recipient&#39;s spend pubkey</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#a25f16695c9edd5985e8be3c51a7eaa80">generate_tx_proof</a>(<span class="keyword">const</span> hash &amp;prefix_hash, <span class="keyword">const</span> public_key &amp;R, <span class="keyword">const</span> public_key &amp;A, <span class="keyword">const</span> std::optional&lt;public_key&gt; &amp;<a class="code" href="namespacebase.html#a17dd1cce6b527da7e5b58e664c70ecc6">B</a>, <span class="keyword">const</span> public_key &amp;D, <span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> &amp;r, signature &amp;sig);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacecrypto.html#acf0fb297d00922e3e9f966901289614f">check_tx_proof</a>(<span class="keyword">const</span> hash &amp;prefix_hash, <span class="keyword">const</span> public_key &amp;R, <span class="keyword">const</span> public_key &amp;A, <span class="keyword">const</span> std::optional&lt;public_key&gt; &amp;<a class="code" href="namespacebase.html#a17dd1cce6b527da7e5b58e664c70ecc6">B</a>, <span class="keyword">const</span> public_key &amp;D, <span class="keyword">const</span> signature &amp;sig);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">/* To send money to a key:</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">   * * The sender generates an ephemeral key and includes it in transaction output.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">   * * To spend the money, the receiver generates a key image from it.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">   * * Then he selects a bunch of outputs, including the one he spends, and uses them to generate a ring signature.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">   * To check the signature, it is necessary to collect all the keys that were used to generate it. To detect double spends, it is necessary to check that each key image is used at most once.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#adf9614e5996e9f8f06ac7f973f41309b">generate_key_image</a>(<span class="keyword">const</span> public_key &amp;pub, <span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a> &amp;sec, key_image &amp;image);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#a1f564d1f52041158240882d1c33d46e8">generate_ring_signature</a>(</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keyword">const</span> hash&amp; prefix_hash,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keyword">const</span> key_image&amp; image,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keyword">const</span> std::vector&lt;const public_key*&gt;&amp; pubs,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a>&amp; sec,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      std::size_t sec_index,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      signature* sig);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacecrypto.html#a1b2e4deebf88db010fd67219bd1b4424">check_ring_signature</a>(</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keyword">const</span> hash&amp; prefix_hash,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keyword">const</span> key_image&amp; image,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keyword">const</span> std::vector&lt;const public_key*&gt;&amp; pubs,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keyword">const</span> signature* sig);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">// Signature on a single key image.  The does the same thing as generate_ring_signature with 1</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">// pubkey (and secret index of 0), but slightly more efficiently, and with hardware device</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">// implementation.  (This is still used for key image export and for exposing key images in stake</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// transactions).</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacecrypto.html#adcc8ca49ecba0d52f35606830b4d7747">generate_key_image_signature</a>(</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keyword">const</span> key_image&amp; image,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keyword">const</span> public_key&amp; pub,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">secret_key</a>&amp; sec,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      signature&amp; sig);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacecrypto.html#adb13a99a1f49080b052860a56a5cc69c">check_key_image_signature</a>(</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keyword">const</span> key_image&amp; image,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keyword">const</span> public_key&amp; pub,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keyword">const</span> signature&amp; sig);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="structstd_1_1hash_3_01crypto_1_1ec__point_01_4.html">  264</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>std::hash&lt;<a class="code" href="namespacecrypto.html">crypto</a>::ec_point&gt; : <a class="code" href="structcrypto_1_1raw__hasher.html">crypto::raw_hasher</a>&lt;crypto::ec_point&gt; {};</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="structstd_1_1hash_3_01crypto_1_1public__key_01_4.html">  265</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>std::hash&lt;<a class="code" href="namespacecrypto.html">crypto</a>::public_key&gt; : <a class="code" href="structcrypto_1_1raw__hasher.html">crypto::raw_hasher</a>&lt;crypto::public_key&gt; {};</div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="structstd_1_1hash_3_01crypto_1_1key__image_01_4.html">  266</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>std::hash&lt;<a class="code" href="namespacecrypto.html">crypto</a>::key_image&gt; : <a class="code" href="structcrypto_1_1raw__hasher.html">crypto::raw_hasher</a>&lt;crypto::key_image&gt; {};</div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="structstd_1_1hash_3_01crypto_1_1signature_01_4.html">  267</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>std::hash&lt;<a class="code" href="namespacecrypto.html">crypto</a>::signature&gt; : <a class="code" href="structcrypto_1_1raw__hasher.html">crypto::raw_hasher</a>&lt;crypto::signature&gt; {};</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="structstd_1_1hash_3_01crypto_1_1ed25519__public__key_01_4.html">  268</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>std::hash&lt;<a class="code" href="namespacecrypto.html">crypto</a>::ed25519_public_key&gt; : <a class="code" href="structcrypto_1_1raw__hasher.html">crypto::raw_hasher</a>&lt;crypto::ed25519_public_key&gt; {};</div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="structstd_1_1hash_3_01crypto_1_1x25519__public__key_01_4.html">  269</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>std::hash&lt;<a class="code" href="namespacecrypto.html">crypto</a>::x25519_public_key&gt; : <a class="code" href="structcrypto_1_1raw__hasher.html">crypto::raw_hasher</a>&lt;crypto::x25519_public_key&gt; {};</div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="structstd_1_1hash_3_01crypto_1_1ed25519__signature_01_4.html">  270</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>std::hash&lt;<a class="code" href="namespacecrypto.html">crypto</a>::ed25519_signature&gt; : <a class="code" href="structcrypto_1_1raw__hasher.html">crypto::raw_hasher</a>&lt;crypto::ed25519_signature&gt; {};</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacecrypto_html_accad1ff5d9765b632ed9bd75e76e6d43"><div class="ttname"><a href="namespacecrypto.html#accad1ff5d9765b632ed9bd75e76e6d43">crypto::secret_key_to_public_key</a></div><div class="ttdeci">bool secret_key_to_public_key(const secret_key &amp;sec, public_key &amp;pub)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:186</div></div>
<div class="ttc" id="astructcrypto_1_1signature_html"><div class="ttname"><a href="structcrypto_1_1signature.html">crypto::signature</a></div><div class="ttdef"><b>Definition:</b> crypto.h:76</div></div>
<div class="ttc" id="astructcrypto_1_1x25519__secret__key___html"><div class="ttname"><a href="structcrypto_1_1x25519__secret__key__.html">crypto::x25519_secret_key_</a></div><div class="ttdef"><b>Definition:</b> crypto.h:103</div></div>
<div class="ttc" id="agroestl__tables_8h_html_a0735f92342601a6dcd26111ace40500a"><div class="ttname"><a href="groestl__tables_8h.html#a0735f92342601a6dcd26111ace40500a">T</a></div><div class="ttdeci">const uint32_t T[512]</div><div class="ttdef"><b>Definition:</b> groestl_tables.h:36</div></div>
<div class="ttc" id="anamespacecrypto_html_ad52cebfd5eeaab09a39314115bfccf6f"><div class="ttname"><a href="namespacecrypto.html#ad52cebfd5eeaab09a39314115bfccf6f">crypto::derive_secret_key</a></div><div class="ttdeci">void derive_secret_key(const key_derivation &amp;derivation, size_t output_index, const secret_key &amp;base, secret_key &amp;derived_key)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:249</div></div>
<div class="ttc" id="anamespacecrypto_html_a25f16695c9edd5985e8be3c51a7eaa80"><div class="ttname"><a href="namespacecrypto.html#a25f16695c9edd5985e8be3c51a7eaa80">crypto::generate_tx_proof</a></div><div class="ttdeci">void generate_tx_proof(const hash &amp;prefix_hash, const public_key &amp;R, const public_key &amp;A, const std::optional&lt; public_key &gt; &amp;B, const public_key &amp;D, const secret_key &amp;r, signature &amp;sig)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:357</div></div>
<div class="ttc" id="astructcrypto_1_1signature_html_ae4fc0a1e1eccf1242e859175e068507b"><div class="ttname"><a href="structcrypto_1_1signature.html#ae4fc0a1e1eccf1242e859175e068507b">crypto::signature::r</a></div><div class="ttdeci">void r(const ec_scalar &amp;r)</div><div class="ttdef"><b>Definition:</b> crypto.h:84</div></div>
<div class="ttc" id="anamespacebase_html"><div class="ttname"><a href="namespacebase.html">base</a></div><div class="ttdef"><b>Definition:</b> base.py:1</div></div>
<div class="ttc" id="astructcrypto_1_1signature_html_affb0ccf512e72c66cb2a4bb22aaaa6c9"><div class="ttname"><a href="structcrypto_1_1signature.html#affb0ccf512e72c66cb2a4bb22aaaa6c9">crypto::signature::c</a></div><div class="ttdeci">unsigned char * c()</div><div class="ttdef"><b>Definition:</b> crypto.h:78</div></div>
<div class="ttc" id="astructcrypto_1_1signature_html_a4b4a734143a3a02dacf2b8d78dea21e6"><div class="ttname"><a href="structcrypto_1_1signature.html#a4b4a734143a3a02dacf2b8d78dea21e6">crypto::signature::c</a></div><div class="ttdeci">void c(const ec_scalar &amp;c)</div><div class="ttdef"><b>Definition:</b> crypto.h:80</div></div>
<div class="ttc" id="anamespacecrypto_html_a700c2f43b09780ce0f8b6d00cec1bdc9"><div class="ttname"><a href="namespacecrypto.html#a700c2f43b09780ce0f8b6d00cec1bdc9">crypto::generate_signature</a></div><div class="ttdeci">signature generate_signature(const hash &amp;prefix_hash, const public_key &amp;pub, const secret_key &amp;sec)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:289</div></div>
<div class="ttc" id="astructcrypto_1_1key__derivation_html"><div class="ttname"><a href="structcrypto_1_1key__derivation.html">crypto::key_derivation</a></div><div class="ttdef"><b>Definition:</b> crypto.h:72</div></div>
<div class="ttc" id="astructcrypto_1_1signature_html_a87cded961e1150be2db3aa28a07943a0"><div class="ttname"><a href="structcrypto_1_1signature.html#a87cded961e1150be2db3aa28a07943a0">crypto::signature::r</a></div><div class="ttdeci">unsigned char * r()</div><div class="ttdef"><b>Definition:</b> crypto.h:82</div></div>
<div class="ttc" id="anamespacebase_html_a17dd1cce6b527da7e5b58e664c70ecc6"><div class="ttname"><a href="namespacebase.html#a17dd1cce6b527da7e5b58e664c70ecc6">base.B</a></div><div class="ttdeci">list B</div><div class="ttdef"><b>Definition:</b> base.py:26</div></div>
<div class="ttc" id="anamespacecrypto_html"><div class="ttname"><a href="namespacecrypto.html">crypto</a></div><div class="ttdoc">crypto namespace.</div><div class="ttdef"><b>Definition:</b> sha256sum.h:7</div></div>
<div class="ttc" id="anamespacecrypto_html_ab89b0197c5ff5ab6ba8e87bd76ef676e"><div class="ttname"><a href="namespacecrypto.html#ab89b0197c5ff5ab6ba8e87bd76ef676e">crypto::secret_key</a></div><div class="ttdeci">epee::mlocked&lt; tools::scrubbed&lt; secret_key_ &gt; &gt; secret_key</div><div class="ttdef"><b>Definition:</b> crypto.h:68</div></div>
<div class="ttc" id="astructcrypto_1_1signature_html_a7811e9dfca37cf268d4a79424dc78ba0"><div class="ttname"><a href="structcrypto_1_1signature.html#a7811e9dfca37cf268d4a79424dc78ba0">crypto::signature::c</a></div><div class="ttdeci">const unsigned char * c() const</div><div class="ttdef"><b>Definition:</b> crypto.h:79</div></div>
<div class="ttc" id="acrypto_2random_8h_html"><div class="ttname"><a href="crypto_2random_8h.html">random.h</a></div></div>
<div class="ttc" id="anamespacecrypto_html_acdb7a135ca10ba49bd82912186ebb19b"><div class="ttname"><a href="namespacecrypto.html#acdb7a135ca10ba49bd82912186ebb19b">crypto::rand_idx</a></div><div class="ttdeci">std::enable_if&lt; std::is_unsigned&lt; T &gt;::value, T &gt;::type rand_idx(T sz)</div><div class="ttdef"><b>Definition:</b> crypto.h:152</div></div>
<div class="ttc" id="anamespacecrypto_html_a829861e5b3c015c323cbda547190055d"><div class="ttname"><a href="namespacecrypto.html#a829861e5b3c015c323cbda547190055d">crypto::generate_key_derivation</a></div><div class="ttdeci">crypto::key_derivation generate_key_derivation(const public_key &amp;key1, const secret_key &amp;key2)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:196</div></div>
<div class="ttc" id="anamespacecrypto_html_a1f564d1f52041158240882d1c33d46e8"><div class="ttname"><a href="namespacecrypto.html#a1f564d1f52041158240882d1c33d46e8">crypto::generate_ring_signature</a></div><div class="ttdeci">void generate_ring_signature(const hash &amp;prefix_hash, const key_image &amp;image, const std::vector&lt; const public_key * &gt; &amp;pubs, const secret_key &amp;sec, size_t sec_index, signature *sig)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:553</div></div>
<div class="ttc" id="astructcrypto_1_1bytes_html_a06d1434cd0b17a3bcba8a01daadc6b97"><div class="ttname"><a href="structcrypto_1_1bytes.html#a06d1434cd0b17a3bcba8a01daadc6b97">crypto::bytes&lt; 32, true &gt;::data_</a></div><div class="ttdeci">std::array&lt; unsigned char, Bytes &gt; data_</div><div class="ttdef"><b>Definition:</b> base.h:20</div></div>
<div class="ttc" id="astructcrypto_1_1ed25519__secret__key___html"><div class="ttname"><a href="structcrypto_1_1ed25519__secret__key__.html">crypto::ed25519_secret_key_</a></div><div class="ttdef"><b>Definition:</b> crypto.h:93</div></div>
<div class="ttc" id="anamespacecrypto_html_adb13a99a1f49080b052860a56a5cc69c"><div class="ttname"><a href="namespacecrypto.html#adb13a99a1f49080b052860a56a5cc69c">crypto::check_key_image_signature</a></div><div class="ttdeci">bool check_key_image_signature(const key_image &amp;image, const public_key &amp;pub, const signature &amp;sig)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:687</div></div>
<div class="ttc" id="astructcrypto_1_1bytes_html_a90e5cb3c7732d48e83b52c9c6b2d7677"><div class="ttname"><a href="structcrypto_1_1bytes.html#a90e5cb3c7732d48e83b52c9c6b2d7677">crypto::bytes&lt; 64, true &gt;::data</a></div><div class="ttdeci">unsigned char * data()</div><div class="ttdef"><b>Definition:</b> base.h:22</div></div>
<div class="ttc" id="anamespacecrypto_html_ac56b84b74a2730200de5932b1e9b3d5a"><div class="ttname"><a href="namespacecrypto.html#ac56b84b74a2730200de5932b1e9b3d5a">crypto::x25519_secret_key</a></div><div class="ttdeci">epee::mlocked&lt; tools::scrubbed&lt; x25519_secret_key_ &gt; &gt; x25519_secret_key</div><div class="ttdef"><b>Definition:</b> crypto.h:104</div></div>
<div class="ttc" id="anamespacecrypto_html_a075f95a5c71c1122b5f77074c4fc23b4"><div class="ttname"><a href="namespacecrypto.html#a075f95a5c71c1122b5f77074c4fc23b4">crypto::ed25519_secret_key</a></div><div class="ttdeci">epee::mlocked&lt; tools::scrubbed&lt; ed25519_secret_key_ &gt; &gt; ed25519_secret_key</div><div class="ttdef"><b>Definition:</b> crypto.h:94</div></div>
<div class="ttc" id="acrypto_2base_8h_html"><div class="ttname"><a href="crypto_2base_8h.html">base.h</a></div></div>
<div class="ttc" id="astructcrypto_1_1random__device_html"><div class="ttname"><a href="structcrypto_1_1random__device.html">crypto::random_device</a></div><div class="ttdef"><b>Definition:</b> crypto.h:132</div></div>
<div class="ttc" id="anamespacecrypto_html_a342de1d43c4f9cc51f267469284f73b9"><div class="ttname"><a href="namespacecrypto.html#a342de1d43c4f9cc51f267469284f73b9">crypto::derive_subaddress_public_key</a></div><div class="ttdeci">bool derive_subaddress_public_key(const public_key &amp;out_key, const key_derivation &amp;derivation, std::size_t output_index, public_key &amp;derived_key)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:257</div></div>
<div class="ttc" id="anamespacecrypto_html_a4cfb16d15839aee35fbf7e30aa49e2dd"><div class="ttname"><a href="namespacecrypto.html#a4cfb16d15839aee35fbf7e30aa49e2dd">crypto::generate_keys</a></div><div class="ttdeci">secret_key generate_keys(public_key &amp;pub, secret_key &amp;sec, const secret_key &amp;recovery_key, bool recover)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:159</div></div>
<div class="ttc" id="anamespacecrypto_html_a1550cf25f2aebaf6dc33db1d7bc91958"><div class="ttname"><a href="namespacecrypto.html#a1550cf25f2aebaf6dc33db1d7bc91958">crypto::generate_random_bytes_thread_safe</a></div><div class="ttdeci">void generate_random_bytes_thread_safe(size_t N, uint8_t *bytes)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:94</div></div>
<div class="ttc" id="anamespacecrypto_html_adf9614e5996e9f8f06ac7f973f41309b"><div class="ttname"><a href="namespacecrypto.html#adf9614e5996e9f8f06ac7f973f41309b">crypto::generate_key_image</a></div><div class="ttdeci">void generate_key_image(const public_key &amp;pub, const secret_key &amp;sec, key_image &amp;image)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:525</div></div>
<div class="ttc" id="astructcrypto_1_1secret__key___html"><div class="ttname"><a href="structcrypto_1_1secret__key__.html">crypto::secret_key_</a></div><div class="ttdef"><b>Definition:</b> crypto.h:67</div></div>
<div class="ttc" id="anamespacecrypto_html_a9d13de4bc0185a688e9a78b752ff2a1f"><div class="ttname"><a href="namespacecrypto.html#a9d13de4bc0185a688e9a78b752ff2a1f">crypto::rand</a></div><div class="ttdeci">void rand(size_t N, uint8_t *bytes)</div><div class="ttdef"><b>Definition:</b> crypto.h:117</div></div>
<div class="ttc" id="astructcrypto_1_1public__key_html"><div class="ttname"><a href="structcrypto_1_1public__key.html">crypto::public_key</a></div><div class="ttdef"><b>Definition:</b> crypto.h:65</div></div>
<div class="ttc" id="anamespacecrypto_html_ac8015c4c3519492dcfeacc5cc1e9bc4d"><div class="ttname"><a href="namespacecrypto.html#ac8015c4c3519492dcfeacc5cc1e9bc4d">crypto::random_scalar</a></div><div class="ttdeci">void random_scalar(unsigned char *bytes)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:125</div></div>
<div class="ttc" id="anamespacecrypto_html_adcc8ca49ecba0d52f35606830b4d7747"><div class="ttname"><a href="namespacecrypto.html#adcc8ca49ecba0d52f35606830b4d7747">crypto::generate_key_image_signature</a></div><div class="ttdeci">void generate_key_image_signature(const key_image &amp;image, const public_key &amp;pub, const secret_key &amp;sec, signature &amp;sig)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:662</div></div>
<div class="ttc" id="astructcrypto_1_1x25519__public__key_html"><div class="ttname"><a href="structcrypto_1_1x25519__public__key.html">crypto::x25519_public_key</a></div><div class="ttdef"><b>Definition:</b> crypto.h:101</div></div>
<div class="ttc" id="astructcrypto_1_1ec__scalar_html_ae08361a85f18a2f8d8cdb3252cf86de0"><div class="ttname"><a href="structcrypto_1_1ec__scalar.html#ae08361a85f18a2f8d8cdb3252cf86de0">crypto::ec_scalar::operator!=</a></div><div class="ttdeci">bool operator!=(const ec_scalar &amp;x) const</div><div class="ttdef"><b>Definition:</b> crypto.h:60</div></div>
<div class="ttc" id="anamespacecrypto_html_a5dbb69c6a4a5276a98142e36f63bbb0b"><div class="ttname"><a href="namespacecrypto.html#a5dbb69c6a4a5276a98142e36f63bbb0b">crypto::rand_range</a></div><div class="ttdeci">std::enable_if&lt; std::is_integral&lt; T &gt;::value, T &gt;::type rand_range(T range_min, T range_max)</div><div class="ttdef"><b>Definition:</b> crypto.h:143</div></div>
<div class="ttc" id="anamespacecrypto_html_ad91deb84b3eac266145c5329598f282a"><div class="ttname"><a href="namespacecrypto.html#ad91deb84b3eac266145c5329598f282a">crypto::hash_to_scalar</a></div><div class="ttdeci">void hash_to_scalar(const void *data, size_t length, ec_scalar &amp;res)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:145</div></div>
<div class="ttc" id="anamespacerct_html_ad77d0fb2279743febea3fb652f96c77b"><div class="ttname"><a href="namespacerct.html#ad77d0fb2279743febea3fb652f96c77b">rct::copy</a></div><div class="ttdeci">void copy(key &amp;AA, const key &amp;A)</div><div class="ttdef"><b>Definition:</b> rctOps.h:77</div></div>
<div class="ttc" id="astructcrypto_1_1signature_html_a22fdf0da6faeaee04ca83e4474b808cd"><div class="ttname"><a href="structcrypto_1_1signature.html#a22fdf0da6faeaee04ca83e4474b808cd">crypto::signature::r</a></div><div class="ttdeci">const unsigned char * r() const</div><div class="ttdef"><b>Definition:</b> crypto.h:83</div></div>
<div class="ttc" id="astructcrypto_1_1random__device_html_aae1bc3cc2e6c8fdb609eb2ff5ceeb787"><div class="ttname"><a href="structcrypto_1_1random__device.html#aae1bc3cc2e6c8fdb609eb2ff5ceeb787">crypto::random_device::operator()</a></div><div class="ttdeci">result_type operator()() const</div><div class="ttdef"><b>Definition:</b> crypto.h:137</div></div>
<div class="ttc" id="astructcrypto_1_1bytes_html"><div class="ttname"><a href="structcrypto_1_1bytes.html">crypto::bytes</a></div><div class="ttdef"><b>Definition:</b> base.h:19</div></div>
<div class="ttc" id="anamespacecrypto_html_a5afa607436148c43b0682fbb63fca7c7"><div class="ttname"><a href="namespacecrypto.html#a5afa607436148c43b0682fbb63fca7c7">crypto::derive_public_key</a></div><div class="ttdeci">bool derive_public_key(const key_derivation &amp;derivation, size_t output_index, const public_key &amp;base, public_key &amp;derived_key)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:229</div></div>
<div class="ttc" id="astructcrypto_1_1ec__scalar_html"><div class="ttname"><a href="structcrypto_1_1ec__scalar.html">crypto::ec_scalar</a></div><div class="ttdef"><b>Definition:</b> crypto.h:57</div></div>
<div class="ttc" id="astdbool_8h_html_a1062901a7428fdd9c7f180f5e01ea056"><div class="ttname"><a href="stdbool_8h.html#a1062901a7428fdd9c7f180f5e01ea056">bool</a></div><div class="ttdeci">int bool</div><div class="ttdef"><b>Definition:</b> stdbool.h:35</div></div>
<div class="ttc" id="anamespacecrypto_html_a4ae124b7833ddd01cfd9ef6a47c902f4"><div class="ttname"><a href="namespacecrypto.html#a4ae124b7833ddd01cfd9ef6a47c902f4">crypto::null&lt; secret_key &gt;</a></div><div class="ttdeci">const secret_key null&lt; secret_key &gt;</div><div class="ttdef"><b>Definition:</b> crypto.h:70</div></div>
<div class="ttc" id="astructcrypto_1_1ec__scalar_html_a8e4b5bb2649281e3460ee2f61298e0b2"><div class="ttname"><a href="structcrypto_1_1ec__scalar.html#a8e4b5bb2649281e3460ee2f61298e0b2">crypto::ec_scalar::operator==</a></div><div class="ttdeci">bool operator==(const ec_scalar &amp;x) const</div><div class="ttdef"><b>Definition:</b> crypto.cpp:84</div></div>
<div class="ttc" id="anamespaceserialization_html_a2c903a13fe2f03de6d83908a3be64bcf"><div class="ttname"><a href="namespaceserialization.html#a2c903a13fe2f03de6d83908a3be64bcf">serialization::value</a></div><div class="ttdeci">void value(Archive &amp;ar, T &amp;v)</div><div class="ttdoc">Serialization functions. These are used to add/read a value to/from an ongoing serialization.</div><div class="ttdef"><b>Definition:</b> serialization.h:205</div></div>
<div class="ttc" id="astructcrypto_1_1ec__point_html"><div class="ttname"><a href="structcrypto_1_1ec__point.html">crypto::ec_point</a></div><div class="ttdef"><b>Definition:</b> crypto.h:52</div></div>
<div class="ttc" id="astructcrypto_1_1random__device_html_acb2b7fc7b2eddf8df0a53da949480ce7"><div class="ttname"><a href="structcrypto_1_1random__device.html#acb2b7fc7b2eddf8df0a53da949480ce7">crypto::random_device::result_type</a></div><div class="ttdeci">uint64_t result_type</div><div class="ttdef"><b>Definition:</b> crypto.h:134</div></div>
<div class="ttc" id="ahash_8h_html"><div class="ttname"><a href="hash_8h.html">hash.h</a></div></div>
<div class="ttc" id="astructcrypto_1_1key__image_html"><div class="ttname"><a href="structcrypto_1_1key__image.html">crypto::key_image</a></div><div class="ttdef"><b>Definition:</b> crypto.h:74</div></div>
<div class="ttc" id="anamespacecrypto_html_a0ea5e169709b097e7868684aeb1a9a37"><div class="ttname"><a href="namespacecrypto.html#a0ea5e169709b097e7868684aeb1a9a37">crypto::check_key</a></div><div class="ttdeci">bool check_key(const public_key &amp;key)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:181</div></div>
<div class="ttc" id="astructcrypto_1_1ed25519__public__key_html"><div class="ttname"><a href="structcrypto_1_1ed25519__public__key.html">crypto::ed25519_public_key</a></div><div class="ttdef"><b>Definition:</b> crypto.h:90</div></div>
<div class="ttc" id="anamespacecrypto_html_a001bf17b07412f27d556b3f937c144bb"><div class="ttname"><a href="namespacecrypto.html#a001bf17b07412f27d556b3f937c144bb">crypto::add_extra_entropy_thread_safe</a></div><div class="ttdeci">void add_extra_entropy_thread_safe(const void *ptr, size_t bytes)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:100</div></div>
<div class="ttc" id="anamespacecrypto_html_a1b2e4deebf88db010fd67219bd1b4424"><div class="ttname"><a href="namespacecrypto.html#a1b2e4deebf88db010fd67219bd1b4424">crypto::check_ring_signature</a></div><div class="ttdeci">bool check_ring_signature(const hash &amp;prefix_hash, const key_image &amp;image, const std::vector&lt; const public_key * &gt; &amp;pubs, const signature *sig)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:622</div></div>
<div class="ttc" id="anamespaceepee_1_1net__utils_html_a746609002779213cd81f8754611bce59"><div class="ttname"><a href="namespaceepee_1_1net__utils.html#a746609002779213cd81f8754611bce59">epee::net_utils::type</a></div><div class="ttdeci">std::uint8_t type</div><div class="ttdef"><b>Definition:</b> epee_network_address_hack.cpp:19</div></div>
<div class="ttc" id="anamespacecrypto_html_afb4ba722c59e935c7a15d81f93c1560c"><div class="ttname"><a href="namespacecrypto.html#afb4ba722c59e935c7a15d81f93c1560c">crypto::derivation_to_scalar</a></div><div class="ttdeci">void derivation_to_scalar(const key_derivation &amp;derivation, size_t output_index, ec_scalar &amp;res)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:218</div></div>
<div class="ttc" id="anamespacecrypto_html_acf0fb297d00922e3e9f966901289614f"><div class="ttname"><a href="namespacecrypto.html#acf0fb297d00922e3e9f966901289614f">crypto::check_tx_proof</a></div><div class="ttdeci">bool check_tx_proof(const hash &amp;prefix_hash, const public_key &amp;R, const public_key &amp;A, const std::optional&lt; public_key &gt; &amp;B, const public_key &amp;D, const signature &amp;sig)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:430</div></div>
<div class="ttc" id="anamespacecrypto_html_aa9d240b803db22c14272c092c9457187"><div class="ttname"><a href="namespacecrypto.html#aa9d240b803db22c14272c092c9457187">crypto::check_signature</a></div><div class="ttdeci">bool check_signature(const hash &amp;prefix_hash, const public_key &amp;pub, const signature &amp;sig)</div><div class="ttdef"><b>Definition:</b> crypto.cpp:335</div></div>
<div class="ttc" id="astructcrypto_1_1random__device_html_ae0bc45ae433a62210c0009ca3d1b34d2"><div class="ttname"><a href="structcrypto_1_1random__device.html#ae0bc45ae433a62210c0009ca3d1b34d2">crypto::random_device::max</a></div><div class="ttdeci">static constexpr result_type max()</div><div class="ttdef"><b>Definition:</b> crypto.h:136</div></div>
<div class="ttc" id="astructcrypto_1_1raw__hasher_html"><div class="ttname"><a href="structcrypto_1_1raw__hasher.html">crypto::raw_hasher</a></div><div class="ttdef"><b>Definition:</b> base.h:68</div></div>
<div class="ttc" id="astructcrypto_1_1random__device_html_a0bc84178203908cbb72af1be7d535a2a"><div class="ttname"><a href="structcrypto_1_1random__device.html#a0bc84178203908cbb72af1be7d535a2a">crypto::random_device::min</a></div><div class="ttdeci">static constexpr result_type min()</div><div class="ttdef"><b>Definition:</b> crypto.h:135</div></div>
<div class="ttc" id="astructcrypto_1_1ed25519__signature_html"><div class="ttname"><a href="structcrypto_1_1ed25519__signature.html">crypto::ed25519_signature</a></div><div class="ttdef"><b>Definition:</b> crypto.h:96</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 21 2022 01:11:49 for Monero by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
